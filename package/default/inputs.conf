# Monitor ufdbguard logs written by syslog
[monitor:///var/log/ufdbguard]
disabled = true
sourcetype = ufdbguard
index = proxy
# Whitelist only log files (adjust pattern as needed)
whitelist = \.log$
# Follow symlinks if syslog rotates with symlinks
followTail = 0
# Ignore older files (optional, in seconds)
# ignoreOlderThan = 7d
# Set host field from filename or use default
# host_segment = 3

# Alternative: Monitor specific log file
[monitor:///var/log/ufdbguard/ufdbguard.log]
disabled = true
sourcetype = ufdbguard
index = proxy
followTail = 0

# Alternative: Monitor with wildcard for rotated logs
[monitor:///var/log/ufdbguard/*.log]
disabled = true
sourcetype = ufdbguard
index = proxy
followTail = 0

# If syslog writes to dated directories (e.g., /var/log/ufdbguard/2025-11-03/)
[monitor:///var/log/ufdbguard/*/]
disabled = true
sourcetype = ufdbguard
index = proxy
whitelist = \.log$
followTail = 0

# If syslog writes with hostname in path (e.g., /var/log/ufdbguard/proxy_host/)
[monitor:///var/log/ufdbguard/*/]
disabled = true
sourcetype = ufdbguard
index = proxy
whitelist = \.log$
# Extract hostname from directory
host_regex = /var/log/ufdbguard/([^/]+)/
followTail = 0