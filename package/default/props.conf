[ufdbguard]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TRUNCATE = 0
TIME_PREFIX = ufdbguard\[\d+\]\s+
TIME_FORMAT = %Y-%m-%d %H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 25

# Extract all fields from ufdbguard logs
REPORT-ufdbguard_fields = ufdbguard_extract_fields
REPORT-ufdbguard_url_parsing = ufdbguard_parse_url

# Field aliases for CIM compliance
FIELDALIAS-src = src_ip AS src
FIELDALIAS-dest = site AS dest

# Calculated fields
EVAL-vendor_product = "ufdbguard"
EVAL-action = if(decision="PASS", "allowed", if(decision="BLOCK", "blocked", "unknown"))
EVAL-category_type = case(category="searchengine", "Search Engine", category="news", "News", category="checked", "Verified", category="ipv4_src_all", "All IPv4", 1=1, category)
